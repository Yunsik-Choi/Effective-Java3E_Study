# 아이템08 (finalizer와 cleaner 사용을 피하라)

**finalizer는 예측할 수 없고 상황에 따라 위험할 수 있어 일반적으로 불필요하다. cleaner는 finalizer보다는 덜 위험하지만 여전히 예측할 수 없고, 느리고, 일반적으로 불필요하다.**

## Finalizer와 Cleaner가 위험한 이유

- finalizer와 cleaner는 즉시 수행된다는 보장이 없다. 객체에 접근 할 수 없게 된 후 finalizer와 cleaner가 실행되기 까지 얼마나 걸릴지 알 수 없다.
- finalizer와 cleaner의 수행 시점은 GC 알고리즘에 달렸으며 이는 GC마다 천차만별이다. 이는 심각한 성능 문제를 동반한다.
- 수행 시점뿐 아니라 수행 여부조차 보장되지 않는다. 접근할 수 없는 객체에 딸린 종료 작업을 수행하지 못한 채 프로그램이 중단될 수 있기 때문이다. 따라서 상태를 영구적으로 수정하는 작업에는 finalizer와 cleaner를 더더욱 사용해선 안된다.
- finalizer동작 중 발생한 예외는 무시되며 처리할 작업이 남았더라도 그 순간 종료된다.

## Cleaner와 Finalizer를 사용해야되는 상황

- 자원 소요자가 close 메서드를 호출하지 않는 것에 대비한 안전망 역할로 사용한다.
- 네이티브 피어와 연결된 객체에서 사용한다.

### 네이티브 피어란?

네이티브 피어는 C/C++이나 어셈블리 프로그램을 컴파일한 기계어 프로그램를 지칭하는데 이를 라이브러리로써 자바 피어가 실행할 수 있게 해주는 인터페이스를 JNI (Java Native Interface)라고 한다. 네이티브 피어는 GC가 그 존재를 알지 못해 회수하지 못한다.

## 정리

```jsx
cleaner와 finalizer는 안전망 역할이나 중요하지 않은 네이티브 자원 회수 용도로만 사용하자.
물론 이런 경우라도 불확실성과 성능 저하에 주의해야한다.
```